@model WebDuLichDev.Models.CityInfo
@{
    ViewBag.Title = "AddCity";
    Layout = "~/Views/Shared/_Layout.cshtml";
   
}




<h2>AddCity</h2>

@using (Html.BeginForm("AddCity", "City", FormMethod.Post, new { @class = "Add_City ", @id = "frmAddCity" }))
{
    <input name="dlCity.ID" value="@Model.dlCity.ID" type="hidden" />
    <div class="control-group" style="width: 50%">
        <label class="control-label" for="input01">@Resources.Language.City</label>
        <div class="controls">
            @Html.TextBoxFor(m => m.dlCity.CityName)
        </div>
    </div>
  
    <div>
        <ul id="panelbar">
            <li class="k-state-active">
                <span class="k-link k-state-selected">@Resources.Language.BasicInfo</span>
                <div>
                    <div class="control-group">
                        <label class="control-label" for="input01">@Resources.Language.Avatar</label>
                        <div class="controls">
                            <input id="uploadAvatar" name="fileUpload" type="file" />
                            <input id="Avatar" name="dlCity.Avatar" value="@Model.dlCity.Avatar" type="hidden" required="" validationmessage="Please upload {0}" />
                            <div id="imgPhotoAvatar">
                                <div class="row">
                                    <div class="span8">
                                        <ul class="thumbnails">
                                            @if (null != Model && Model.dlCity != null)
                                            {      
                                                @:<li class="span2" id="@Model.dlCity.Avatar"><a class=thumbnail><img src="/Data/Avatar/City/@Model.dlCity.Avatar" alt='' /></a></li>
                                            }
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label" for="input01">@Resources.Language.Introduce</label>
                        <div id="content_city" class="k-content">
                            <textarea id="editor" name="dlCity.Summary" rows="5" cols="20" style="width: 100%; height: 400px">                  
                   @HttpUtility.HtmlDecode(Model.dlCity.Summary);      
                </textarea>
                        </div>
                    </div>
                </div>
            </li>

            <li>
                <span class="">@Resources.Language.DetailInfo</span>
                <div id="tabstrip">
                    <ul>
                        <li class="k-state-active">@Resources.Language.History</li>
                        <li>@Resources.Language.Nature</li>
                        <li>@Resources.Language.Social</li>
                        <li>@Resources.Language.Administrative</li>
                        <li>@Resources.Language.Economy</li>
                        <li>@Resources.Language.Travel</li>
                    </ul>
                    <div>
                        <div class="k-content">
                            <textarea class="editor" id="History" name="dlCityInfoDetail.History" rows="5" cols="20" style="width: 100%; height: 400px">                  
                   @HttpUtility.HtmlDecode(Model.dlCityInfoDetail.History   )   
                </textarea>
                        </div>
                    </div>
                    <div>
                        <div class="k-content">
                            <textarea class="editor" id="Nature" name="dlCityInfoDetail.Nature" rows="5" cols="20" style="width: 100%; height: 400px">                  
                    @HttpUtility.HtmlDecode(Model.dlCityInfoDetail.Nature   )  
                </textarea>
                        </div>
                    </div>
                    <div>
                        <div class="k-content">
                            <textarea class="editor" id="Social" name="dlCityInfoDetail.Social" rows="5" cols="20" style="width: 100%; height: 400px">                  
                   @HttpUtility.HtmlDecode(Model.dlCityInfoDetail.Social )    
                </textarea>
                        </div>
                    </div>
                    <div>
                        <div class="k-content">
                            <textarea class="editor" id="Administrative" name="dlCityInfoDetail.Administrative" rows="5" cols="20" style="width: 100%; height: 400px">                  
                     @HttpUtility.HtmlDecode(Model.dlCityInfoDetail.Administrative   )   
                </textarea>
                        </div>
                    </div>
                    <div>
                        <div class="k-content">
                            <textarea class="editor" id="Economy" name="dlCityInfoDetail.Economy" rows="5" cols="20" style="width: 100%; height: 400px">                  
                   @HttpUtility.HtmlDecode(Model.dlCityInfoDetail.Economy)
                </textarea>
                        </div>
                    </div>
                    <div>
                        <div class="k-content">
                            <textarea class="editor" id="Travel" name="dlCityInfoDetail.Travel" rows="5" cols="20" style="width: 100%; height: 400px">                  
                     @HttpUtility.HtmlDecode(Model.dlCityInfoDetail.Travel)      
                </textarea>
                        </div>
                    </div>
                </div>
            </li>

        </ul>
    </div>
  
    <div class="form-actions" style="width: 50%">
        <input class="btn btn-primary" id="btnSubmit" type="button" value="@Resources.Language.Submit" />
        <input class="btn" id="btnCancel" type="button" value="@Resources.Language.Cancel" />
    </div> 
     
    
}



<script>
    $(document).ready(function () {

        // create Editor from textarea HTML element with default set of tools
        $(".editor").kendoEditor({
           
            encoded:true,
            tools: ["bold", "italic", "underline", "justifyLeft", "justifyCenter", "justifyRight",
                "justifyFull", "insertUnorderedList", "insertOrderedList", "indent", "outdent", "viewHtml"
            ],
           
            
        });
        $("#editor").kendoEditor({

            encoded: true,
            
            tools: ["bold", "italic", "underline", "justifyLeft", "justifyCenter", "justifyRight",
                "justifyFull", "insertUnorderedList", "insertOrderedList", "indent", "outdent", "viewHtml", "insertHtml"
            ],
            insertHtml: [
                   { text: "Chữ ký:", value: "<p>Regards,<br /> By...,<br /></a></p>" }]
        });
        $("#panelbar").kendoPanelBar({
            expandMode: "multiple",
            animation: {
                collapse: {
                    duration: 1000,
                    effects: "fadeOut"
                },
                expand: {
                    duration: 500,
                    effects: "expandVertical fadeIn"
                }

            }
            
        });

        $("#tabstrip").kendoTabStrip({
            animation: {
                open: {
                    effects: ["expandVertical ", "fadeIn"]
                }
                
            }

        });
      
        var validator = $("#panelbar").kendoValidator().data("kendoValidator");

        $('#btnSubmit').click(function () {
            //var editor = $("#editor").data("kendoEditor");
            //var e2 = $("#Travel").data("kendoEditor");
            //var e1 = $("#History").data("kendoEditor");
            //alert(editor.encodedValue());
            //alert(e1.encodedValue() + " ed 2" + e2.encodedValue());
            if (validator.validate()) {
                $('#frmAddCity').submit();
                
               
            } else {
                alert("Oops! There is invalid data in the form.");
            }

        });
    });

</script>



<script>
   
    function htmlEncode(value) {
        if (value) {
            return jQuery('<div />').text(value).html();
        } else {
            return '';
        }
    }
    function htmlDecode(value) {
        if (value) {
            return $('<div />').html(value).text();
        } else {
            return '';
        }
    }
     // logs "<p>foo</p>"
    $('#btnCancel').click(function () {
        
        

    });
</script>





<script>
    $(function () {
        $("#uploadAvatar").kendoUpload({
            localization: {
                remove: "Remove",
                uploadSelectedFiles: "Upload"
            },
            multiple: false,
            async: {
                autoUpload: false,
                saveUrl: '@Url.Action("UploadAvatarCity","City",new {cityId=4})',
                removeUrl: '@Url.Action("RemoveAvatarCity","City",new {cityId=4})'
            },
            select: function () {
                // The upload button will be created after the event is triggered
                // hence the need for a timeout.
                setTimeout(function () {
                    $(".k-upload-selected").insertBefore($(".k-upload-action"))
                });

            },
            select: onSelect,
            upload: onUpload,
            success: onUploadSuccess
        });
    });
    function onUpload(e) {
        var files = e.files;

        // Check the extension of each file and abort the upload if it is not .jpg ,.png ,.bmp
        $.each(files, function () {
            if ((this.extension == ".jpg") || (this.extension == ".png") || (this.extension == ".bmp")) {
                return true;
            }
            else {
                alert("it is not .jpg ,.png ,.bmp");
                e.preventDefault();
            }
        });
    }
    function onProgress(e) {
        // Array with information about the uploaded files
        var files = e.files;

        console.log(e.percentComplete);
    }
    function onUploadSuccess(e) {
        var files = e.files;

        if (e.operation == "upload") {
            $.each(files, function () {
                $('#Avatar').val(this.name);
                $('#imgPhotoAvatar > .row > .span8 > .thumbnails').append("<li class='span2' id=" + this.name + " ><a class=thumbnail><img src=/Data/Avatar/City/" + this.name + " alt='' /></a></li>");

            });
        }

        if (e.operation == "remove") {
            $.each(files, function () {
                $('#Avatar').val('');
                $('div#imgPhotoAvatar > .row > .span8 > .thumbnails > li').remove();
            });
        }
    }
    function onSelect(e) {
        var files = e.files;

        // Check the extension of each file and abort the upload if it is not .jpg ,.png ,.bmp
        $.each(files, function () {
            //alert(this.extension);
            if ((this.extension == ".jpg") || (this.extension == ".png") || (this.extension == ".bmp")) {
                return true;
            }
            else {
                alert("it is not .jpg ,.png ,.bmp"); e.preventDefault();
            }
        });
    }
</script>





@*<script> 
    $(document).ready(function () {

        var data = [
            { text: "An Giang", value: "1" },
            { text: "Bà Rịa - Vũng Tàu", value: "2" },
            { text: "Bắc Giang", value: "3" },
            { text: "Bắc Kạn", value: "4" },
            { text: "Bạc Liêu", value: "5" },
            { text: "Bắc Ninh", value: "6" },
            { text: "Bến Tre", value: "7" },
            { text: "Bình Định", value: "8" },
            { text: "Bình Dương", value: "9" },
            { text: "Bình Phước", value: "10" },
            { text: "Bình Thuận", value: "11" },
            { text: "Cà Mau", value: "12" },
            { text: "Cao Bằng", value: "13" },
            { text: "Đắk Lắk", value: "14" },
            { text: "Đắk Nông", value: "15" },
            { text: "Điện Biên", value: "16" },
            { text: "Đồng Nai", value: "17" },
            { text: "Đồng Tháp", value: "18" },
            { text: "Gia Lai", value: "19" },
            { text: "Hà Giang", value: "20" },
            { text: "Hà Nam", value: "21" },
            { text: "Hà Tĩnh", value: "22" },
            { text: "Hải Dương", value: "23" },
            { text: "Hậu Giang", value: "" },
            { text: "Hòa Bình", value: "" },
            { text: "Hưng Yên", value: "" },
            { text: "Khánh Hòa", value: "" },
            { text: "Kiên Giang", value: "" },
            { text: "Kon Tum", value: "" },
            { text: "Lai Châu", value: "" },
            { text: "Lâm Đồng", value: "" },
            { text: "Lạng Sơn", value: "" },
            { text: "Lào Cai", value: "" },
            { text: "Long An", value: "" },
            { text: "Nam Định", value: "" },
            { text: "Nghệ An", value: "" },
            { text: "Ninh Bình", value: "" },
            { text: "Ninh Thuận", value: "" },
            { text: "Phú Thọ", value: "" },
            { text: "Quảng Bình", value: "" },
            { text: "Quảng Nam", value: "" },
            { text: "Quảng Ngãi", value: "" },
            { text: "Quảng Ninh", value: "" },
            { text: "Quảng Trị", value: "" },
            { text: "Sóc Trăng", value: "" },
            { text: "Sơn La", value: "" },
            { text: "Tây Ninh", value: "" },
            { text: "Thái Bình", value: "" },
            { text: "Thái Nguyên", value: "" },
            { text: "Thanh Hóa", value: "" },
            { text: "Thừa Thiên - Huế", value: "" },
            { text: "Tiền Giang", value: "" },
            { text: "Trà Vinh", value: "" },
            { text: "Tuyên Quang", value: "" },
            { text: "Vĩnh Long", value: "" },

            { text: "Vĩnh Phúc", value: "" },
            { text: "Yên Bái", value: "" },
            { text: "Phú Yên", value: "" },
            { text: "Cần Thơ", value: "" },
            { text: "Đà Nẵng", value: "" },
            { text: "Hải Phòng", value: "" },
            { text: "Hà Nội", value: "" },
            { text: "TP Hồ Chí Minh", value: "" },

        ];

        $("#select").kendoMultiSelect({
            dataTextField: "text",
            dataValueField: "value",
            dataSource: data,
            placeholder: "Select City...",
            //dataBound: onDataBound,
            select: onSelectCity,
            //change: onChangeCity,
            close: onCloseCity,
            //open: onOpen,
            maxSelectedItems: 1
        });
    });
    function onSelectCity(e) {
        var dataItem = this.dataSource.view()[e.item.index()];
        $.ajax({
            url: '@Url.Content("/City/SetCityID")',
            data: { cityID: dataItem.value },
            type: 'GET',
            dataType: 'json',
            success: function (data) {
                alert("Da set");
                // ...
            },
            error: function () {
                // ...
            }
        });
       
        //alert("City" + dataItem.text + " " + dataItem.value);
    }
    function onCloseCity(e) {
        //var dataItem = this.dataSource.view()[e.item.index()];

       // alert("City change to");
    }
</script>*@
